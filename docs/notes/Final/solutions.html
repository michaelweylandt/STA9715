<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>STA 9715: Final Exam (Fall 2024) – Solutions – STA 9715</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../">
<script src="../../site_libs/quarto-html/quarto.js"></script>
<script src="../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../index.html">
    <span class="navbar-title">STA 9715</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item">
    <a class="nav-link" href="../.././syllabus.html"> 
<span class="menu-text">Syllabus</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../.././notes.html"> 
<span class="menu-text">Handouts and Additional Notes</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../.././resources.html"> 
<span class="menu-text">Additional Resources</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../.././objectives.html"> 
<span class="menu-text">Learning Objectives</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
        
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">STA 9715: Final Exam (Fall 2024) – Solutions</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  


</header>


<p><span class="math display">\[\newcommand{\P}{\mathbb{P}}\newcommand{\E}{\mathbb{E}} \newcommand{\V}{\mathbb{V}} \newcommand{\bX}{\mathbf{X}} \newcommand{\bA}{\mathbf{A}} \newcommand{\bI}{\mathbf{I}} \newcommand{\C}{\mathbb{C}} \newcommand{\M}{\mathbb{M}} \newcommand{\R}{\mathbb{R}}  \newcommand{\bZ}{\mathbf{Z}} \newcommand{\bb}{\mathbf{b}} \newcommand{\by}{\mathbf{y}} \newcommand{\bSigma}{\mathbf{\Sigma}} \newcommand{\bzero}{\mathbf{0}} \newcommand{\bbeta}{\mathbf{\beta}} \newcommand{\bepsilon}{\mathbf{\epsilon}}\]</span> The original exam packet can be found <a href="./ExamPacket.pdf">here</a>.</p>
<section id="question-1" class="level4">
<h4 class="anchored" data-anchor-id="question-1">Question 1</h4>
<p>Suppose <span class="math inline">\(X\)</span> is a continuous random variable with PDF proportional to <span class="math inline">\(x^2(1-x)^5\)</span> and support on <span class="math inline">\([0, 1]\)</span>. What is <span class="math inline">\(\E[X]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-1-contents" aria-controls="callout-1" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-1" class="callout-1-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is similar to a question from Test 3, but here you need to pattern match on a beta distribution instead of a gamma distribution.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-2-contents" aria-controls="callout-2" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-2" class="callout-2-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We recognize this as the PDF of a <span class="math inline">\(\text{Beta}(3, 6)\)</span> distribution, hence it has <span class="math display">\[\E[X] = \frac{\alpha}{\alpha + \beta} = \frac{3}{3+6} = \frac{1}{3} \approx 33.3\%\]</span>.</p>
<p>We can verify that samples from this distribution have the right “shape”:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb1"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(<span class="fl">1e6</span>, <span class="dv">3</span>, <span class="dv">6</span>)</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="at">length.out=</span><span class="dv">401</span>)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(X, <span class="at">probability=</span><span class="cn">TRUE</span>)</span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, x<span class="sc">^</span><span class="dv">2</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span><span class="dv">5</span> <span class="sc">/</span> <span class="fu">beta</span>(<span class="dv">3</span>, <span class="dv">6</span>), <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here we’re cheating a bit however since we assumed / knew the normalizing constant (<span class="math inline">\(1/B(3, 6)\)</span>) to make the curves match up. It is possible, albeit a bit slower, to get samples from a distribution with unknown normalizing constant (and unknown distribution ID) using a technique called “rejection sampling.” See discussion <a href="https://stats.stackexchange.com/a/182526">on Cross-Validated</a>.</p>
</div>
</div>
</div>
</section>
<section id="question-2" class="level4">
<h4 class="anchored" data-anchor-id="question-2">Question 2</h4>
<p>Let <span class="math inline">\(T\)</span> be the time until a radioactive particle decays and suppose that <span class="math inline">\(T \sim \text{Exponential}(10)\)</span>. The <em>half-life</em> of the particle is the time at which there is a 50% chance that the particle has decayed (<em>i.e.</em>, the median of <span class="math inline">\(T\)</span>). What is the half life of <span class="math inline">\(T\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-3-contents" aria-controls="callout-3" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-3" class="callout-3-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This question appeared essentially <em>verbatim</em> on Test 1, but here we set <span class="math inline">\(\lambda = 10\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-4-contents" aria-controls="callout-4" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-4" class="callout-4-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Recall the solution <a href="../Test1/solutions.html#question-10">given on Test 1</a>, where we found</p>
<p><span class="math display">\[\tau_{\text{Half-Life}} = \frac{\log 2}{\lambda}\]</span></p>
<p>Here, this becomes</p>
<p><span class="math display">\[\tau_{\text{Half-Life}} = \frac{\log 2}{10} \approx 0.0693\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-3" class="level4">
<h4 class="anchored" data-anchor-id="question-3">Question 3</h4>
<p>Suppose grades on a certain exam are normally distributed with mean 70 and standard deviation 4. Using the Gaussian Chernoff bound, approximate the probability that a given student gets a grade of 90 or higher.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-5-contents" aria-controls="callout-5" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-5" class="callout-5-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This question is substantially the same as <a href="../Test3/solutions.html#question-18">a question on Test 3</a>, with different numbers.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-6-contents" aria-controls="callout-6" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-6" class="callout-6-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We modify the solution given in the Test 3 solutions.</p>
<p>As always, we standardize our variables to perform this type of calculation:</p>
<p><span class="math display">\[\begin{align*}
\P(\text{Grade} \geq 90) &amp;= \P(70 + 4Z \geq 90) \\
                         &amp;= \P(4Z \geq 20) \\
                         &amp;= \P(Z \geq 5)
\end{align*}\]</span></p>
<p>Here, we apply the Chernoff bound to have</p>
<p><span class="math display">\[\P(Z \geq 5) \leq e^{-5^2/2} = e^{-12.5} \approx 0.003726653\%\]</span></p>
<p>As we move into the tails, we see that this simple bound is suprisingly accurate:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb2"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="fu">exp</span>(<span class="sc">-</span>(<span class="dv">5</span><span class="sc">^</span><span class="dv">2</span>)<span class="sc">/</span><span class="dv">2</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.726653e-06</code></pre>
</div>
<div class="sourceCode cell-code" id="cb4"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fu">pnorm</span>(<span class="dv">5</span>, <span class="at">lower.tail=</span><span class="cn">FALSE</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.866516e-07</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-4" class="level4">
<h4 class="anchored" data-anchor-id="question-4">Question 4</h4>
<p>Let <span class="math inline">\(X_1, X_2, \dots\)</span> be a series of IID <span class="math inline">\(\chi^2_6\)</span> random variables and let <span class="math inline">\(Y_1, Y_2, \dots\)</span> be a series of IID <span class="math inline">\(\chi^2_{4}\)</span> random variables. (All <span class="math inline">\(X_i, Y_j\)</span> are independent as well.) Let <span class="math display">\[\widetilde{S}_n = \frac{1}{n} \sum_{i=1}^n \frac{X_i}{Y_i}.\]</span> What is the limiting value of <span class="math inline">\(\widetilde{X}_n\)</span> as <span class="math inline">\(n \to \infty\)</span>?</p>
<p><em>Hint: What is the distribution of each term <span class="math inline">\(T_i = \frac{X_i}{Y_i}\)</span>? You may want to multiply by a constant.</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-7-contents" aria-controls="callout-7" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-7" class="callout-7-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is similar to a LLN question from Test 3, here replacing a (scaled) <span class="math inline">\(F\)</span> distribution for a squared <span class="math inline">\(t\)</span> distribution.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-8-contents" aria-controls="callout-8" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-8" class="callout-8-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because each term <span class="math inline">\(T_i\)</span> is a ratio of <span class="math inline">\(\chi^2\)</span> random variables, we recognize it as being similar to an <span class="math inline">\(F\)</span> distribution. To make it <em>exactly</em> an <span class="math inline">\(F\)</span> distribution, we must divide the numerator and the denominator by the degrees of freedom as follows:</p>
<p><span class="math display">\[T_i \sim \frac{\chi^2_6}{\chi^2_4} \sim  \frac{6}{4} * \frac{\chi^2_6/6}{\chi^2_4/4} \sim 1.5 * F_{6, 4}\]</span></p>
<p>Hence, we recognize the sum as the scaled average of many independent <span class="math inline">\(F_{6,4}\)</span> random variables, so <span class="math display">\[\widetilde{S}_n \buildrel P \over \to \E[T_1] = \E[1.5 F_{6,4}] = 1.5 \E[F_{6,4}] = \frac{3}{2} * \frac{4}{4-2} = 3.\]</span></p>
<p>We can, as always, verify this in simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb6"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">6</span>)</span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rchisq</span>(n, <span class="dv">4</span>)</span>
<span id="cb6-4"><a href="#cb6-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-5"><a href="#cb6-5" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X <span class="sc">/</span> Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 3.004006</code></pre>
</div>
</div>
<p>as desired.</p>
</div>
</div>
</div>
</section>
<section id="question-5" class="level4">
<h4 class="anchored" data-anchor-id="question-5">Question 5</h4>
<p>A certain family has 5 children, 2 girls and 3 boys. Assuming all birth orders are equally likely, what is the probability that the youngest and the oldest children are both girls?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-9-contents" aria-controls="callout-9" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-9" class="callout-9-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a minor modification of a question from Test 1.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-10-contents" aria-controls="callout-10" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-10" class="callout-10-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Suppose that the two girls are named <span class="math inline">\(G_1\)</span> and <span class="math inline">\(G_2\)</span>; there are two orders in which they could be born, <span class="math inline">\(G_1, G_2\)</span> and <span class="math inline">\(G_2, G_1\)</span>. Similarly, there are <span class="math inline">\(3! = 6\)</span> orders in which the boys could be born. This gives a total of <span class="math inline">\(12=2 * 6\)</span> possible birth orders that fit our criterion. We can get the probability of this event (set of outcomes) by dividing by the total number of outcomes, <span class="math inline">\(5!=120\)</span>, giving a final probability of <span class="math inline">\(12/120 = 10\%\)</span>.</p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb8"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb8-2"><a href="#cb8-2" aria-hidden="true" tabindex="-1"></a>    births <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="st">"G"</span>, <span class="st">"G"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>, <span class="st">"B"</span>))</span>
<span id="cb8-3"><a href="#cb8-3" aria-hidden="true" tabindex="-1"></a>    ordered <span class="ot">&lt;-</span> (births[<span class="dv">1</span>] <span class="sc">==</span> <span class="st">"G"</span>) <span class="sc">&amp;&amp;</span> (births[<span class="dv">5</span>] <span class="sc">==</span> <span class="st">"G"</span>) <span class="co"># Indicator RVs!</span></span>
<span id="cb8-4"><a href="#cb8-4" aria-hidden="true" tabindex="-1"></a>})</span>
<span id="cb8-5"><a href="#cb8-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb8-6"><a href="#cb8-6" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(R)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.10032</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-6" class="level4">
<h4 class="anchored" data-anchor-id="question-6">Question 6</h4>
<p>Let <span class="math inline">\(Z_1, Z_2, Z_3\)</span> be three IID uniform random variables on the interval <span class="math inline">\([0, 1]\)</span>. What is the CDF of <span class="math inline">\(Z_* = \min\{Z_1, Z_2, Z_3\}\)</span>?</p>
<p><em>Hint: Note that, for a single uniform random variable,</em> <span class="math inline">\(F_{Z_1}(z) = z\)</span> for <span class="math inline">\(z \in [0, 1]\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-11-contents" aria-controls="callout-11" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-11" class="callout-11-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a minor modification of a problem from Test 3, with the uniform CDF replacing the normal CDF.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-12-contents" aria-controls="callout-12" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-12" class="callout-12-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By analogy with <a href="../Test3/solutions.html#question-2">the similar previous question</a>, we find <span class="math display">\[F_{Z_*}(z) = \begin{cases} 0 &amp; z &lt; 0 \\ 1-(1-z^3) &amp; z\in[0, 1] \\ 1 &amp; z &gt; 1 \end{cases}.\]</span></p>
<p>We show this in simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb10"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>n  <span class="ot">&lt;-</span> <span class="fl">1e5</span></span>
<span id="cb10-2"><a href="#cb10-2" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-3"><a href="#cb10-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-4"><a href="#cb10-4" aria-hidden="true" tabindex="-1"></a>Z3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb10-5"><a href="#cb10-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-6"><a href="#cb10-6" aria-hidden="true" tabindex="-1"></a>Z_star <span class="ot">&lt;-</span> <span class="fu">pmin</span>(Z1, Z2, Z3)</span>
<span id="cb10-7"><a href="#cb10-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-8"><a href="#cb10-8" aria-hidden="true" tabindex="-1"></a>CDF_Z_star <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(Z_star)</span>
<span id="cb10-9"><a href="#cb10-9" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-10"><a href="#cb10-10" aria-hidden="true" tabindex="-1"></a>z <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(Z_star), <span class="fu">max</span>(Z_star), <span class="at">length.out=</span><span class="dv">401</span>)</span>
<span id="cb10-11"><a href="#cb10-11" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-12"><a href="#cb10-12" aria-hidden="true" tabindex="-1"></a>CDF_theoretical <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">-</span> (<span class="dv">1</span><span class="sc">-</span>z)<span class="sc">^</span><span class="dv">3</span></span>
<span id="cb10-13"><a href="#cb10-13" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb10-14"><a href="#cb10-14" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(CDF_Z_star, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"black"</span>, </span>
<span id="cb10-15"><a href="#cb10-15" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"CDF of The Minimum of 3 IID Standard Uniform Distributions"</span>)</span>
<span id="cb10-16"><a href="#cb10-16" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(z, CDF_theoretical, <span class="at">lwd=</span><span class="dv">2</span>, <span class="at">col=</span><span class="st">"red4"</span>)</span>
<span id="cb10-17"><a href="#cb10-17" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red4"</span>), <span class="at">lwd=</span><span class="dv">2</span>, </span>
<span id="cb10-18"><a href="#cb10-18" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"Sample CDF"</span>, <span class="st">"Theoretical CDF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-7" class="level4">
<h4 class="anchored" data-anchor-id="question-7">Question 7</h4>
<p>Suppose <span class="math inline">\(X\)</span> has MGF <span class="math inline">\(\M_X(t) = e^{5t + 8t^2}\)</span>. What is the standard deviation of <span class="math inline">\(X\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-13-contents" aria-controls="callout-13" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-13" class="callout-13-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a minor variant of a question from Test 3, here replacing a Gamma MGF with a Normal MGF.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-14-contents" aria-controls="callout-14" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-14" class="callout-14-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We can solve this in two ways:</p>
<ol type="1">
<li><p>We can recognize this as a Normal MGF of the format <span class="math display">\[\M_{\mu + \sigma Z}(t) = \exp\left\{\mu t + \frac{\sigma^2}{2} t^2\right\}\]</span> so <span class="math inline">\(X \sim \mathcal{N}(5, 4^2)\)</span> and hence <span class="math inline">\(X\)</span> has a standard deviation of <span class="math inline">\(4\)</span>.</p></li>
<li><p>If we do not recognize this as a common MGF, we can differentiate through the MGF to get the first and second central moments.</p>
<p><span class="math display">\[\begin{align*}
\M'_X(t) &amp;= (5 t + 8 * t^2)' \M_X(t) \\
          &amp;= (5 + 16 t) \M_X(t) \\
\implies \M'_X(0) &amp;= (5+ 16 * 0) \underbrace{\M_X(0)}_{=1} \\
                   &amp;= 5 \\
\end{align*}\]</span></p>
<p>and</p>
<p><span class="math display">\[\begin{align*}
\M''_X(t) &amp;= (5+ 16t) \M'_X(t) + (5 + 16t)' \M_X(t) \\
           &amp;= (5 + 16t)^2 \M_X(t) + 16 \M_X(t) \\
\implies \M''_X(0) &amp;= (5 + 16 * 0)^2 \underbrace{\M_X(0)}_{=1} + 16 \underbrace{\M_X(0)}_{=1}\\
           &amp;= 5^2 + 16 \\
           &amp;= 41
\end{align*}\]</span></p>
<p>Hence, <span class="math display">\[\V[X] = \E[X]^2 - \E[X]^2 = M''_X(0) - M'_X(0)^2 = 41 - 5^2 = 16\]</span> which gives a standard deviation of 4 for <span class="math inline">\(X\)</span>.</p></li>
</ol>
</div>
</div>
</div>
</section>
<section id="question-8" class="level4">
<h4 class="anchored" data-anchor-id="question-8">Question 8</h4>
<p>Four players, named A, B, C, and D, are playing a card game. A standard well-shuffled deck of cards is dealt to the players so each player receives a 5 card hand. How many possibilities are there for the hand that player A will get? (Within a hand, the order in which cards were received doesn’t matter.)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-15-contents" aria-controls="callout-15" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-15" class="callout-15-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a question from Test 1 with a different size of hand.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-16-contents" aria-controls="callout-16" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-16" class="callout-16-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because we do not care about the hands held by B, C, or D, we can approach this as a simple combinatorics problem:</p>
<p><span class="math display">\[\binom{52}{5} =  \frac{52!}{5!(52-5)!} = \frac{52 * 51 * 50 * 49 * 48}{5 * 4 * 3 * 2 * 1} = 2598960\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-9" class="level4">
<h4 class="anchored" data-anchor-id="question-9">Question 9</h4>
<p>Let <span class="math inline">\(X_1 = 4 - 2Z_1 + 4Z_2\)</span> and <span class="math inline">\(X_2 = 1 + 3Z_1 - 9Z_2\)</span> where <span class="math inline">\(Z_1, Z_2\)</span> are independent standard normal variables. What is the covariance of <span class="math inline">\(X_1\)</span> and <span class="math inline">\(X_2\)</span>, <em>i.e.</em>, <span class="math inline">\(\C[X_1, X_2]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-17-contents" aria-controls="callout-17" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-17" class="callout-17-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a modification of a question from Test 2 with different weights and asking for covariance instead of correlation.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-18-contents" aria-controls="callout-18" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-18" class="callout-18-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We apply our standard calculations:</p>
<p><span class="math display">\[\begin{align*}
\C[X_1, X_2] &amp;= \C[4 - 2Z_1 + 4Z_2, 1 + 3Z_1 - 9Z_2] \\
             &amp;= \C[- 2Z_1 + 4Z_2, 3Z_1 - 9Z_2] \\
             &amp;= (-2)(3)\C[Z_1, Z_1] + (-2)(-9)\C[Z_1, Z_2] + (4)(3)\C[Z_2, Z_1] + (4)(-9)\C[Z_2, Z_2] \\
             &amp;= -6\V[Z_1] + 18 * 0 + 12 * 0 -36 \V[Z_2] \\
             &amp;= -6 * 1 -36 * 1 \\
             &amp;= -42
\end{align*}\]</span></p>
<p>In matrix notation, we simply compute:</p>
<p><span class="math display">\[\begin{align*}
\begin{pmatrix} -2 &amp; 4 \\3  &amp; -9 \end{pmatrix}\begin{pmatrix} -2 &amp; 4 \\3  &amp; -9 \end{pmatrix}^{\top} = \begin{pmatrix} 20 &amp; -42 \\ -40 &amp; 90 \end{pmatrix}
\end{align*}\]</span></p>
<p>From which we can read off <span class="math inline">\(\C[X_1, X_2] = -42\)</span>.</p>
<p>As always, in simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb11"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>Z1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb11-3"><a href="#cb11-3" aria-hidden="true" tabindex="-1"></a>Z2 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n)</span>
<span id="cb11-4"><a href="#cb11-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-5"><a href="#cb11-5" aria-hidden="true" tabindex="-1"></a>X1 <span class="ot">&lt;-</span> <span class="dv">4</span> <span class="sc">-</span> <span class="dv">2</span> <span class="sc">*</span> Z1 <span class="sc">+</span> <span class="dv">4</span> <span class="sc">*</span> Z2</span>
<span id="cb11-6"><a href="#cb11-6" aria-hidden="true" tabindex="-1"></a>X2 <span class="ot">&lt;-</span> <span class="dv">1</span> <span class="sc">+</span> <span class="dv">3</span> <span class="sc">*</span> Z1 <span class="sc">-</span> <span class="dv">9</span> <span class="sc">*</span> Z2</span>
<span id="cb11-7"><a href="#cb11-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-8"><a href="#cb11-8" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X1, X2)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -41.98663</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-10" class="level4">
<h4 class="anchored" data-anchor-id="question-10">Question 10</h4>
<p>The <span class="math inline">\(\text{Rayleigh}(\beta)\)</span> distribution has CDF <span class="math inline">\(F_Y(y) = 1 - e^{-y^2/2\beta}\)</span>. Suppose you have a source of uniform random variables <span class="math inline">\(U\)</span>. Find a transform of <span class="math inline">\(U\)</span>, <span class="math inline">\(h(\cdot)\)</span>, such that <span class="math inline">\(h(U) \sim \text{Rayleigh}(5)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-19-contents" aria-controls="callout-19" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-19" class="callout-19-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 3, with the Rayleigh replacing the Weibull distribution.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-20-contents" aria-controls="callout-20" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-20" class="callout-20-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Since we have a simple CDF, we are able to apply the probability integral transform. We begin by inverting the CDF:</p>
<p><span class="math display">\[ \begin{align*}
u &amp;= 1 - e^{-y^2/2\beta} \\
e^{-y^2/2\beta} &amp;= 1-u \\
-\frac{y^2}{2\beta} &amp;= \log(1-u) \\
y^2 &amp;= -2\beta \log(1-u) \\
y &amp;= \sqrt{-2\beta\log(1-u)}
\end{align*}\]</span></p>
<p>As usual, we can simplify slightly by noting <span class="math inline">\(U \buildrel d \over = 1-U\)</span> to get:</p>
<p><span class="math display">\[Y = \sqrt{-2\beta \log U}\]</span></p>
<p>Hence we can sample from a Rayleigh(5) distribution as <span class="math inline">\(Y = \sqrt{-10\log U}\)</span>.</p>
<p>In code,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb13"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>rRayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(n, beta){</span>
<span id="cb13-2"><a href="#cb13-2" aria-hidden="true" tabindex="-1"></a>    U <span class="ot">&lt;-</span> <span class="fu">runif</span>(n)</span>
<span id="cb13-3"><a href="#cb13-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sqrt</span>(<span class="sc">-</span><span class="dv">2</span> <span class="sc">*</span> beta <span class="sc">*</span> <span class="fu">log</span>(U))</span>
<span id="cb13-4"><a href="#cb13-4" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>We can verify that the sample CDF matches our desired CDF:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb14"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rRayleigh</span>(<span class="fl">1e5</span>, <span class="dv">5</span>)</span>
<span id="cb14-2"><a href="#cb14-2" aria-hidden="true" tabindex="-1"></a>X_cdf <span class="ot">&lt;-</span> <span class="fu">ecdf</span>(X)</span>
<span id="cb14-3"><a href="#cb14-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-4"><a href="#cb14-4" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(X_cdf, <span class="at">main=</span><span class="st">"Rayleigh(5) CDF"</span>, <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb14-5"><a href="#cb14-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-6"><a href="#cb14-6" aria-hidden="true" tabindex="-1"></a>x <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="dv">0</span>, <span class="fu">max</span>(X), <span class="at">length.out=</span><span class="dv">401</span>)</span>
<span id="cb14-7"><a href="#cb14-7" aria-hidden="true" tabindex="-1"></a>R_cdf <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">-</span><span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">10</span>)</span>
<span id="cb14-8"><a href="#cb14-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-9"><a href="#cb14-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(x, R_cdf, <span class="at">col=</span><span class="st">"red4"</span>)</span>
<span id="cb14-10"><a href="#cb14-10" aria-hidden="true" tabindex="-1"></a><span class="fu">legend</span>(<span class="st">"topleft"</span>, </span>
<span id="cb14-11"><a href="#cb14-11" aria-hidden="true" tabindex="-1"></a>       <span class="at">col=</span><span class="fu">c</span>(<span class="st">"black"</span>, <span class="st">"red4"</span>), </span>
<span id="cb14-12"><a href="#cb14-12" aria-hidden="true" tabindex="-1"></a>       <span class="at">lwd =</span> <span class="dv">2</span>, </span>
<span id="cb14-13"><a href="#cb14-13" aria-hidden="true" tabindex="-1"></a>       <span class="at">legend=</span><span class="fu">c</span>(<span class="st">"PRNG CDF"</span>, <span class="st">"Theoretical CDF"</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Numerically,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb15"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>pRayleigh <span class="ot">&lt;-</span> <span class="cf">function</span>(x, <span class="at">beta =</span> <span class="dv">5</span>) <span class="dv">1</span> <span class="sc">-</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span> <span class="sc">*</span> beta))</span>
<span id="cb15-2"><a href="#cb15-2" aria-hidden="true" tabindex="-1"></a><span class="fu">ks.test</span>(X, pRayleigh)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
    Asymptotic one-sample Kolmogorov-Smirnov test

data:  X
D = 0.0041427, p-value = 0.06461
alternative hypothesis: two-sided</code></pre>
</div>
</div>
<p>A great match!</p>
</div>
</div>
</div>
</section>
<section id="question-11" class="level4">
<h4 class="anchored" data-anchor-id="question-11">Question 11</h4>
<p>Let <span class="math inline">\(P_1, \dots, P_{40}\)</span> be IID Poisson random variables, each with mean <span class="math inline">\(2\)</span>. Using the CLT, approximate the probability that <span class="math inline">\(\P(\sum_{i=1}^{40} P_i &gt; 100)\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-21-contents" aria-controls="callout-21" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-21" class="callout-21-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a combination of two problems from Test 3: one using a CLT approximation to bound a sum and one on the distribution of the average of Poisson variates.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-22-contents" aria-controls="callout-22" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-22" class="callout-22-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first note that each <span class="math inline">\(P_i\)</span> has <span class="math inline">\(\E[P_i] = \V[P_i] = 2\)</span> by standard properties of the Poisson, so if we let <span class="math inline">\(\overline{P}_{40}\)</span> be their average, the CLT gives us <span class="math display">\[\overline{P}_{40} \buildrel d \over \approx \mathcal{N}\left(2,
\frac{2}{40}\right) = \mathcal{N}\left(2, 0.05\right).\]</span> We then note that</p>
<p><span class="math display">\[\begin{align*}
\P\left(\sum_{i=1}^{40} P_i &gt; 100\right) &amp;= \P\left(\overline{P} &gt; 2.5\right)  \\
&amp;= \approx \P(2 + \sqrt{0.05}Z &gt; 2.5) \\
&amp;= \P(\sqrt{0.05}Z &gt; 0.5) \\
&amp;= \P(Z &gt; 0.5/\sqrt{0.05}) \\
&amp;= 1 - \P(Z \leq 0.5/\sqrt{0.05}) \\
&amp;= 1-\Phi(0.5/\sqrt{0.05}) \\
&amp;\approx 1.27\%
\end{align*}\]</span></p>
<p>In simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb17"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e6</span>, {</span>
<span id="cb17-2"><a href="#cb17-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">rpois</span>(<span class="dv">40</span>, <span class="at">lambda=</span><span class="dv">2</span>)) <span class="sc">&gt;</span> <span class="dv">100</span></span>
<span id="cb17-3"><a href="#cb17-3" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.013126</code></pre>
</div>
</div>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Alternate Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-23-contents" aria-controls="callout-23" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Alternate Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-23" class="callout-23-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><strong>A typo on the version of the exam given to students indicated that 50 variables could be used instead. Full marks are given for a correct answer for either form of the problem.</strong></p>
<p>We first note that each <span class="math inline">\(P_i\)</span> has <span class="math inline">\(\E[P_i] = \V[P_i] = 2\)</span> by standard properties of the Poisson, so if we let <span class="math inline">\(\overline{P}_{50}\)</span> be their average, the CLT gives us <span class="math display">\[\overline{P}_{50} \buildrel d \over \approx \mathcal{N}\left(2,
\frac{2}{50}\right) = \mathcal{N}\left(2, 0.04\right).\]</span> We then note that</p>
<p><span class="math display">\[\begin{align*}
\P\left(\sum_{i=1}^{50} P_i &gt; 100\right) &amp;= \P\left(\overline{P} &gt; 2\right)  \\
&amp;= \approx \P(2 + \sqrt{0.04}Z &gt; 2) \\
&amp;= \P(\sqrt{0.04}Z &gt; 0) \\
&amp;= \P(Z &gt; 0) \\
&amp;\approx 50\%
\end{align*}\]</span></p>
<p>In simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb19"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e6</span>, {</span>
<span id="cb19-2"><a href="#cb19-2" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(<span class="fu">rpois</span>(<span class="dv">50</span>, <span class="at">lambda=</span><span class="dv">2</span>)) <span class="sc">&gt;=</span> <span class="dv">100</span></span>
<span id="cb19-3"><a href="#cb19-3" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.513097</code></pre>
</div>
</div>
<p>So there is some discrepancy here - and it’s not entirely clear how we should handle any “continuity correction” - but the approximation is still rather accurate.</p>
</div>
</div>
</div>
</section>
<section id="question-12" class="level4">
<h4 class="anchored" data-anchor-id="question-12">Question 12</h4>
<p>Let <span class="math inline">\(X_1, X_2, \dots\)</span> be IID random variables with mean <span class="math inline">\(\mu\)</span> and finite variance <span class="math inline">\(\sigma^2\)</span>. Find a value of <span class="math inline">\(n\)</span> (an integer) such that the sample mean <span class="math inline">\(\overline{X}_n\)</span> is within 1 standard deviation of the mean with probability 99% or greater.</p>
<p><em>Hint: Chebyshev</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-24-contents" aria-controls="callout-24" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-24" class="callout-24-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 3, now requiring us to be within 1 standard deviation instead of 2.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-25-contents" aria-controls="callout-25" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-25" class="callout-25-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We modify our solution from a <a href="../Test3/solutions.html#question-11">prior question</a>.</p>
<p>We recall Chebyshev’s inequality as follows:</p>
<p><span class="math display">\[\P(|X - \mu| &gt; k\sigma) \leq \frac{1}{k^2}\]</span></p>
<p>or equivalently,</p>
<p><span class="math display">\[\P(|X - \mu| &lt; k\sigma) \geq 1 - \frac{1}{k^2}\]</span></p>
<p>Here, we are applying Chebyshev to a sample mean, so we scale the standard deviation by <span class="math inline">\(1/\sqrt{n}\)</span> to obtain:</p>
<p><span class="math display">\[\P(|\overline{X}_n - \mu| &lt; k\sigma / \sqrt{n}) \geq 1 - \frac{1}{k^2}\]</span></p>
<p>If we want the right hand side to be 99% (so that we are within the bounds), we clearly have <span class="math inline">\(k = 10\)</span> and we need <span class="math inline">\(k/\sqrt{n} = 1\)</span>, giving a minimum sample size of <span class="math display">\[\frac{10}{\sqrt{n}} = 10 \implies n = 100\]</span></p>
<p>For <em>any</em> (finite-variance) random variable, the sample mean of 25 IID realizations will be within one standard deviation of the mean with 99% probability (or higher). Note that, the number of samples required by Chebyshev’s inequality grows <em>quadratically</em> (25 for 2 SDs to 100 for a 1 SD guarantee), as opposed to methods based on Chernoff bounds which will grow logarithmically.</p>
</div>
</div>
</div>
</section>
<section id="question-13" class="level4">
<h4 class="anchored" data-anchor-id="question-13">Question 13</h4>
<p>According to the numbers I just made up, students with dogs are 15 times more likely to loose their homework than students who don’t. If 10% of students in a class have a dog, what is the probability that a student who lost their homework has a dog?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-26-contents" aria-controls="callout-26" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-26" class="callout-26-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This echoes the CDC question from Test 1, but with different numbers.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-27-contents" aria-controls="callout-27" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-27" class="callout-27-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(D\)</span> be the event “has a dog” and <span class="math inline">\(L\)</span> be the event “lost homework”. The problem then gives us <span class="math display">\[\P(D) = 0.1 \implies \P(D^c) = 0.9 \text{ and } \P(L | D) = 15 \P(L | D^c)\]</span></p>
<p>We put these into a Bayes’ rule calculation:</p>
<p><span class="math display">\[\begin{align*}
\P(D | L) &amp;= \frac{\P(L | D) * \P(D)}{\P(L)} \\
          &amp;= \frac{\P(L | D) * \P(D)}{\P(L|D)\P(D) + \P(L|D^c)\P(D^c)} \\
          &amp;= \frac{\P(L | D) * 0.1}{\P(L|D)*0.1 + \P(L|D^c) * 0.9} \\
          &amp;= \frac{\P(L | D)}{\P(L|D) + 9\P(L|D^c)} \\
          &amp;= \frac{15\P(L | D^c)}{15\P(L|D^c) + 9\P(L|D^c)} \\
          &amp;= \frac{15}{15 + 9} \\
          &amp;= \frac{5}{8} \approx 62.5\%
\end{align*}\]</span></p>
<p>If you want to do this “directly” by partitioning an outcome space, consider a class of 1,000 students. By assumption 100 will have dogs and 900 won’t. If 15 of the 900 lose their homework, that is a rate of <span class="math inline">\(1/60\)</span> for non-dog owners; this implies that <span class="math inline">\(1/4 = 15 * 1/60\)</span> of dog owners will lose their work, here 25. We thus have 40 total lost pieces of work, of which 25 are dog-owners, giving a final probability of <span class="math inline">\(25/40 = 5/8\)</span>.</p>
<p>Note that here we had to select 15/900 as our base rate: the problem doesn’t actually give us a true base rate, but since terms cancel in Bayes’ Rule that isn’t a problem. (In general, if a calculation has to hold for any value, you can simply select a value that gives simple calculations and it must hold there as well.)</p>
</div>
</div>
</div>
</section>
<section id="question-14" class="level4">
<h4 class="anchored" data-anchor-id="question-14">Question 14</h4>
<p>The train I take to get to work averages 45 minutes. Use Markov’s inequality to give an upper bound on the probability it takes me more than 2 hours to get to work.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-28-contents" aria-controls="callout-28" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-28" class="callout-28-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a slight variant of the Markov’s inequality question from Test 2.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-29-contents" aria-controls="callout-29" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-29" class="callout-29-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Let <span class="math inline">\(T\)</span> be my travel time and <span class="math inline">\(\E[T] = 2\)</span>; then, by Markov’s inequality: <span class="math display">\[\P(T &gt; 2) \leq \frac{\E[T]}{2} = \frac{0.75}{2} = \frac{3}{8} = 37.5\%\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-15" class="level4">
<h4 class="anchored" data-anchor-id="question-15">Question 15</h4>
<p>Let <span class="math inline">\(X \sim \text{Gamma}(4, 2)\)</span> and <span class="math inline">\(Y \sim \text{Gamma}(1, 5)\)</span>. What is <span class="math inline">\(\V[XY]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-30-contents" aria-controls="callout-30" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-30" class="callout-30-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 2, but here with Gamma distributions instead of normal distributions.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-31-contents" aria-controls="callout-31" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-31" class="callout-31-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We modify <a href="./Test2/solutions.html#question-11">our previous solution</a> to use the new distributions.</p>
<p>Before we begin, let’s recall that, for <span class="math inline">\(A \sim \text{Gamma}(k, \theta)\)</span>, we have <span class="math display">\[\E[A] = k\theta \text{ and } \V[A] = k\theta^2 \implies \E[A^2] = \E[A]^2 + \V[A] = (k\theta)^2 + k\theta^2 = \theta^2(k^2+k).\]</span></p>
<p>In our context, this gives us:</p>
<p><span class="math display">\[\E[X] = 8, \V[X] = 16, \E[X^2] = 80\]</span></p>
<p>and</p>
<p><span class="math display">\[\E[Y] = 5, \V[Y] = 25, \E[Y^2] = 50\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[\begin{align*}
\V[XY] &amp;= \E[(XY)^2] - \E[XY]^2 \\
       &amp;= \E[X^2Y^2] - \E[XY]^2 \\
       &amp;= \E[X^2]\E[Y^2] - \E[X]^2\E[Y]^2 \quad \text{ (By independence)} \\
       &amp;= 50 * 80 - 8^2 * 5^2 \\
       &amp;= 2400
\end{align*}\]</span></p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb21"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb21-2"><a href="#cb21-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">4</span>, <span class="at">scale=</span><span class="dv">2</span>)</span>
<span id="cb21-3"><a href="#cb21-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">1</span>, <span class="at">scale=</span><span class="dv">5</span>)</span>
<span id="cb21-4"><a href="#cb21-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb21-5"><a href="#cb21-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X <span class="sc">*</span> Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2411.664</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-16" class="level4">
<h4 class="anchored" data-anchor-id="question-16">Question 16</h4>
<p>Suppose that <span class="math inline">\((X, Y)\)</span> are binary random variables generated according to the following joint distribution. What is the <em>covariance</em> of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>?</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th><span class="math inline">\(\P\)</span></th>
<th><span class="math inline">\(X=0\)</span></th>
<th><span class="math inline">\(X=1\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(Y=0\)</span></td>
<td><span class="math inline">\(\frac{1}{4}\)</span></td>
<td><span class="math inline">\(\frac{1}{3}\)</span></td>
</tr>
<tr class="even">
<td><span class="math inline">\(Y=1\)</span></td>
<td><span class="math inline">\(\frac{1}{6}\)</span></td>
<td><span class="math inline">\(\frac{1}{4}\)</span></td>
</tr>
</tbody>
</table>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-32-contents" aria-controls="callout-32" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-32" class="callout-32-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A variant of this question with different probabilities appeared on Test 2.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-33-contents" aria-controls="callout-33" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-33" class="callout-33-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first note the marginal distributions:</p>
<p><span class="math display">\[\P(X=0) = \P(X=0, Y=0) + \P(X=0, Y=1) = \frac{1}{4} + \frac{1}{6} = \frac{5}{12} \implies \P(X=1) = \frac{7}{12}\]</span></p>
<p><span class="math display">\[\P(Y=0) = \P(Y=0, X=0) + \P(Y=0, X=1) = \frac{1}{4} + \frac{1}{3} = \frac{7}{12} \implies \P(Y=1) = \frac{5}{12}\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[\E[X] = \sum_{x=0}^1 \P(X=x) * x = \frac{5}{12} * 0 + \frac{7}{12} * 1 = \frac{7}{12}\]</span></p>
<p><span class="math display">\[\E[Y] = \sum_{y=0}^1 \P(Y=y) * x = \frac{7}{12} * 0 + \frac{5}{12} * 1 = \frac{5}{12}\]</span> and</p>
<p><span class="math display">\[\E[XY] = \sum_{x, y= 0}^1 \P(X=x, Y=y) * x * y = \frac{1}{4} * 0 * 0 + \frac{1}{3} * 1 * 0 + \frac{1}{6} * 0 * 1 + \frac{1}{4} * 1 * 1 = \frac{1}{4}\]</span> so</p>
<p><span class="math display">\[\C[X, Y] = \E[XY] - \E[X]\E[Y] = \frac{1}{4} - \frac{5}{12} * \frac{7}{12} = \frac{1}{144}\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-17" class="level4">
<h4 class="anchored" data-anchor-id="question-17">Question 17</h4>
<p>The <em>Poisson-Gamma</em> compound distribution makes draws from a Poisson random variable whose mean is itself Gamma distributed. For example, let <span class="math inline">\(X \sim \text{Gamma}(5, 2)\)</span> and let <span class="math inline">\(Y | X \sim \text{Poisson}(X)\)</span>. Then the variable <span class="math inline">\(Y\)</span> has a Poisson-Gamma distribution. What is the (unconditional) variance of <span class="math inline">\(Y\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-34-contents" aria-controls="callout-34" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-34" class="callout-34-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of the Beta-Binomial question from Test 3, here replacing the Beta-Binomial with the Poisson-Gamma. (Both of these combinations are important in Bayesian statistics.)</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-35-contents" aria-controls="callout-35" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-35" class="callout-35-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We use the Law of Total Variance, or what BH calls Eve’s Law, to consider this conditionally on knowing <span class="math inline">\(X\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\V[Y] &amp;= \V_X[\E_Y[Y|X]] + \E_X[\V[Y|X]] \\
      &amp;= \V_X[X] + \E[X] \quad \text{ (Mean and variance of Poisson are both $X$)} \\
      &amp;= 5 * 2^2 + 5 * 2 \\
      &amp;= 30
\end{align*}\]</span></p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb23"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb23-2"><a href="#cb23-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rgamma</span>(n, <span class="dv">5</span>, <span class="at">scale =</span> <span class="dv">2</span>)</span>
<span id="cb23-3"><a href="#cb23-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, X)</span>
<span id="cb23-4"><a href="#cb23-4" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(Y)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 29.96191</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-18" class="level4">
<h4 class="anchored" data-anchor-id="question-18">Question 18</h4>
<p>Let <span class="math inline">\((X, Y)\)</span> come from a multivariate normal distribution with mean <span class="math inline">\(\vec{\mu} = (5, 2)\)</span> and variance matrix <span class="math display">\[\mathbf{\Sigma} = \begin{pmatrix} 36 &amp; -8 \\ -8 &amp; 16 \end{pmatrix}\]</span> What is the correlation of <span class="math inline">\(X\)</span> and <span class="math inline">\(Y\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-36-contents" aria-controls="callout-36" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-36" class="callout-36-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question asked on Test 2.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-37-contents" aria-controls="callout-37" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-37" class="callout-37-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We simply read relevant values from the variance matrix:</p>
<p><span class="math display">\[\V[X] = 36, \V[Y] = 16, \C[X, Y] = -8 \implies \rho_{X, Y} = \frac{\C[X, Y]}{\sqrt{\V[X]\V[Y]}} = \frac{-8}{\sqrt{36 * 16}} = -\frac{1}{3} = -33.3\%\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-19" class="level4">
<h4 class="anchored" data-anchor-id="question-19">Question 19</h4>
<p>Let <span class="math inline">\(X, Y\)</span> have a joint distribution with PDF of the form <span class="math display">\[f_{(X, Y)}(x, y) = c \exp\left\{-\frac{x^2}{6}-\frac{y^2}{54} + \frac{xy}{18}\right\} = c\exp\left\{-\frac{2}{3}\left(\frac{x^2}{4} + \frac{y^2}{36} -\frac{xy}{12}\right)\right\}\]</span> supported on <span class="math inline">\(\R^2\)</span> (that is, <span class="math inline">\(X, Y\)</span> can both be any real number). What is <span class="math inline">\(c\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-38-contents" aria-controls="callout-38" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-38" class="callout-38-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a question from Test 8 with the addition of a covariance (cross) term.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-39-contents" aria-controls="callout-39" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-39" class="callout-39-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We recognize this as an instance of the bivariate normal PDF, so we perform some basic pattern matching. I have already done the hard work of finding the correct arrangement of constants. The bivariate normal PDF has the form:</p>
<p><span class="math display">\[
-\frac{1}{2[1-\rho^2]}\left(\frac{x^2}{\sigma_X^2} - \frac{2\rho xy}{\sigma_X\sigma_Y} + \frac{y^2}{\sigma_Y^2}\right)\]</span></p>
<p>so we have <span class="math inline">\(\sigma_X = 2, \sigma_Y=6\)</span>. To find the correlation, <span class="math inline">\(\rho\)</span>, we note</p>
<p><span class="math display">\[\begin{align*}
-\frac{1}{2[1-\rho^2]} &amp;= -\frac{2}{3}\\
2[1-\rho^2] &amp;= \frac{3}{2}\\
1-\rho^2 &amp;= \frac{3}{4}\\
\rho^2 &amp;= \frac{1}{4} \\
\rho &amp;= \pm \frac{1}{2}
\end{align*}\]</span></p>
<p>To get the right sign, we note that the cross term has a negative coefficient already, so we must have <span class="math inline">\(\rho = +1/2\)</span>.</p>
<p>We can check our work by comparing to the cross term:</p>
<p><span class="math display">\[-\frac{2\rho}{\sigma_X\sigma_Y} = -\frac{2 * 1/2}{2 * 6} = -\frac{1}{12}\]</span></p>
<p>as desired. Finally, we note that the normalization constant for the bivariate normal is</p>
<p><span class="math display">\[c = \frac{1}{2\pi\sigma_X\sigma_Y\sqrt{1-\rho^2}} = \frac{1}{2\pi * 2 * 6 * \sqrt{1-0.5^2}} = \frac{1}{24\pi\sqrt{0.75}} = \frac{1}{12\pi\sqrt{3}} \approx 0.0153\]</span></p>
<p>We can check this with bivariate integration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb25"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, y) <span class="dv">1</span><span class="sc">/</span>(<span class="dv">12</span> <span class="sc">*</span> <span class="fu">sqrt</span>(<span class="dv">3</span>) <span class="sc">*</span> pi) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">6</span> <span class="sc">-</span> y<span class="sc">^</span><span class="dv">2</span><span class="sc">/</span><span class="dv">54</span> <span class="sc">+</span> x <span class="sc">*</span> y <span class="sc">/</span> <span class="dv">18</span>)</span>
<span id="cb25-2"><a href="#cb25-2" aria-hidden="true" tabindex="-1"></a>inner_int <span class="ot">&lt;-</span> <span class="cf">function</span>(y) <span class="fu">integrate</span>(<span class="cf">function</span>(x) <span class="fu">f</span>(x, y), <span class="at">lower=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper=</span><span class="cn">Inf</span>)<span class="sc">$</span>value</span>
<span id="cb25-3"><a href="#cb25-3" aria-hidden="true" tabindex="-1"></a>inner_int <span class="ot">&lt;-</span> <span class="fu">Vectorize</span>(inner_int, <span class="st">"y"</span>)</span>
<span id="cb25-4"><a href="#cb25-4" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(inner_int, <span class="at">lower=</span><span class="sc">-</span><span class="cn">Inf</span>, <span class="at">upper=</span><span class="cn">Inf</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1.000001 with absolute error &lt; 4.1e-05</code></pre>
</div>
</div>
<p>as desired.</p>
</div>
</div>
</div>
</section>
<section id="question-20" class="level4">
<h4 class="anchored" data-anchor-id="question-20">Question 20</h4>
<p>A vineyard produces two types of wine: white and red. White wine sells at $25 per bottle and comprises 75% of their production, with the rest being red selling at $50 per bottle. Historically, 10% of the white wine is “spoiled” in transit to America, while 20% of the red is “spoiled.” If a customer calls asking for a refund for a spoiled bottle, what is the expected size of the refund? (Assume that the purchase price is fully refunded.)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-40-contents" aria-controls="callout-40" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-40" class="callout-40-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new problem, based on one of the student-submitted practice problems.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-41-contents" aria-controls="callout-41" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-41" class="callout-41-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>To compute the expected refund, we need the probabilities that a given spoiled bottle is either white or red. We thus apply Bayes’ rule:</p>
<p><span class="math display">\[\begin{align*}
\P(\text{Red}|\text{Spoiled}) &amp;= \frac{\P(\text{Spoiled}|\text{Red}) * \P(\text{Red})}{\P(\text{Spoiled})} \\
&amp;= \frac{\P(\text{Spoiled}|\text{Red}) * \P(\text{Red})}{\P(\text{Spoiled}|\text{Red}) * \P(\text{Red})+\P(\text{Spoiled}|\text{White}) * \P(\text{White})} \\
&amp;= \frac{0.2 * 0.25}{0.2 * 0.25 + 0.1 * 0.75} \\
&amp;= 40\% \\
\implies \P(\text{White} | \text{Spoiled}) &amp;= 1 - \P(\text{Red} | \text{Spoiled}) \\
&amp;= 60\%
\end{align*}\]</span></p>
<p>Hence</p>
<p><span class="math display">\[\begin{align*}
\E[\text{Refund}|\text{Spoiled}] &amp;= \E[\text{Refund}|\text{Red}, \text{Spoiled}] * \P(\text{Red}|\text{Spoiled}) + \E[\text{Refund}|\text{White}, \text{Spoiled}] * \P(\text{White}|\text{Spoiled}) \\
&amp;= \$50 * 40\% + $25 * 60\% \\
&amp;= \$35
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-21" class="level4">
<h4 class="anchored" data-anchor-id="question-21">Question 21</h4>
<p>Let <span class="math inline">\(P\)</span> be a point chosen uniformly at random on the surface of the Earth. What is the probability that <span class="math inline">\(P\)</span> falls in the Northern or Western hemispheres?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-42-contents" aria-controls="callout-42" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-42" class="callout-42-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 2, with an “or” in place of an “and”.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-43-contents" aria-controls="callout-43" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-43" class="callout-43-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
\P(\text{N or W}) &amp;= 1 - \P(\text{Not (N or W)}) \\
                  &amp;= 1 - \P(\text{(Not N) and (Not W)}) \\
                  &amp;= 1 - \P(\text{S and E}) \\
                  &amp;= 1 - \P(\text{S})\P(\text{E}) \\
                  &amp;= 1 - \frac{1}{2}*\frac{1}{2}\\
                  &amp;= 1 - \frac{1}{4} \\
                  &amp;= \frac{3}{4} = 75\%
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-22" class="level4">
<h4 class="anchored" data-anchor-id="question-22">Question 22</h4>
<p>Let <span class="math inline">\(\bZ\)</span> be a vector of 6 independent <span class="math inline">\(\mathcal{N}(1, 1)\)</span> random variables. What is <span class="math inline">\(\E[\|\bZ\|^2]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-44-contents" aria-controls="callout-44" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-44" class="callout-44-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a question from Test 2, here modified to consider a <em>non-central</em> <span class="math inline">\(\chi^2\)</span>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-45-contents" aria-controls="callout-45" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-45" class="callout-45-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For a single coordinate <span class="math inline">\(Z_1 \sim\mathcal{N}(1, 1)\)</span>, we have <span class="math inline">\(\E[Z_1^2] = \E[Z_1]^2 + \V[Z_1] = 1^2 + 1 = 2\)</span>. Hence, <span class="math display">\[\E[\|\bZ\|^2] = \E\left[\sum_{i=1}^6 Z_i^2\right] = \sum_{i=1}^6 \E[Z_i^2] = \sum_{i=1}^6 2 = 12\]</span></p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb27"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">6</span>, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb27-3"><a href="#cb27-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sum</span>(Z<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb27-4"><a href="#cb27-4" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 11.97737</code></pre>
</div>
</div>
<p>Or</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb29"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">rchisq</span>(<span class="fl">1e6</span>, <span class="at">df=</span><span class="dv">6</span>, <span class="at">ncp=</span><span class="dv">6</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 12.00753</code></pre>
</div>
</div>
<p>Note that, in R’s parameterization, the non-centrality parameter (<code>ncp</code>) is the sum of the squared means, here <span class="math inline">\(6\)</span>.</p>
</div>
</div>
</div>
</section>
<section id="question-23" class="level4">
<h4 class="anchored" data-anchor-id="question-23">Question 23</h4>
<p>Suppose a random variable <span class="math inline">\(X\)</span> takes continuous values between <span class="math inline">\(1\)</span> and <span class="math inline">\(4\)</span> and that its PDF is of the form <span class="math inline">\(f_X(x) = cx^3\)</span> for some unknown <span class="math inline">\(c\)</span>. What is <span class="math inline">\(c\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-46-contents" aria-controls="callout-46" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-46" class="callout-46-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question appearing on Test 1.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-47-contents" aria-controls="callout-47" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-47" class="callout-47-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because <span class="math inline">\(f_X(\cdot)\)</span> defines a PDF, it must integrate to 1. Hence,</p>
<p><span class="math display">\[\begin{align*}
c^{-1} &amp;= \int_1^4 x^3\,\text{d}x \\
       &amp;= \left.\frac{x^4}{4}\right|_{x=1}^4 \\
       &amp;= \frac{4^4}{4}-\frac{1^4}{4} \\
       &amp;= \frac{255}{4} \\
\implies c &amp;= \frac{4}{255} \approx 0.00784
\end{align*}\]</span></p>
<p>We verify this via direct integration:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb31"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a><span class="fu">integrate</span>(<span class="cf">function</span>(x) x<span class="sc">^</span><span class="dv">3</span> <span class="sc">*</span> <span class="dv">4</span><span class="sc">/</span><span class="dv">255</span>, <span class="at">lower=</span><span class="dv">1</span>, <span class="at">upper=</span><span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>1 with absolute error &lt; 1.1e-14</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-24" class="level4">
<h4 class="anchored" data-anchor-id="question-24">Question 24</h4>
<p>Suppose that grades in a given course are distributed as follows:</p>
<table class="caption-top table">
<thead>
<tr class="header">
<th>Grade</th>
<th>A</th>
<th>B</th>
<th>C</th>
<th>D</th>
<th>F</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>GPA Points</td>
<td>4</td>
<td>3</td>
<td>2</td>
<td>1</td>
<td>0</td>
</tr>
<tr class="even">
<td>Fraction of Class</td>
<td>25%</td>
<td>40%</td>
<td>25%</td>
<td>5%</td>
<td>5%</td>
</tr>
</tbody>
</table>
<p>Given that a student did not receive an A, what is the probability they receieved a D or an F in the course?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-48-contents" aria-controls="callout-48" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-48" class="callout-48-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a minor tweak of a problem from Test 1.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-49-contents" aria-controls="callout-49" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-49" class="callout-49-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We apply our basic probability rules:</p>
<p><span class="math display">\[\begin{align*}
\P(\text{D or F} | \text{Not A}) &amp;= \frac{\P(\text{(D or F) and (Not A)})}{\P(\text{Not A})} \\
&amp;= \frac{\P(\text{(D or F)})}{1-\P(\text{A})} \\
&amp;= \frac{\P(\text{D}) + \P(\text{F)})}{1-\P(\text{A})} \\
&amp;= \frac{0.05 + 0.05}{1-0.25} \\
&amp;= \frac{2}{15} \approx 13.3\%
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-25" class="level4">
<h4 class="anchored" data-anchor-id="question-25">Question 25</h4>
<p>In a dice game, Player A rolls 2 6-sided dice and takes the higher score; Player B rolls one 6-sided dice. If Player A’s score (max of two) is higher than Player B’s (one roll), then Player A wins; if Player B’s roll is greater than or equal to both of Player A’s rolls, then Player B wins. (That is, a “tie” goes to Player B). What is the probability that Player A wins this game?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-50-contents" aria-controls="callout-50" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-50" class="callout-50-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question and a surprisingly</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-51-contents" aria-controls="callout-51" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-51" class="callout-51-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We first determine the distribution of Player A’s combined score:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 16%">
<col style="width: 16%">
<col style="width: 17%">
<col style="width: 16%">
</colgroup>
<thead>
<tr class="header">
<th><span class="math inline">\(\P(A = 1)\)</span></th>
<th><span class="math inline">\(\P(A = 2)\)</span></th>
<th><span class="math inline">\(\P(A = 3)\)</span></th>
<th><span class="math inline">\(\P(A = 4)\)</span></th>
<th><span class="math inline">\(\P(A = 5)\)</span></th>
<th><span class="math inline">\(\P(A = 6)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(1/36\)</span></td>
<td><span class="math inline">\(3/36 = 1/9\)</span></td>
<td><span class="math inline">\(5/36\)</span></td>
<td><span class="math inline">\(7/36\)</span></td>
<td><span class="math inline">\(9/36 = 1/4\)</span></td>
<td><span class="math inline">\(11/36\)</span></td>
</tr>
</tbody>
</table>
<p>Next, we compute the probability of B winning or tying for each of A’s scores:</p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 9%">
<col style="width: 12%">
<col style="width: 13%">
<col style="width: 13%">
<col style="width: 12%">
<col style="width: 9%">
</colgroup>
<thead>
<tr class="header">
<th></th>
<th><span class="math inline">\(A = 1\)</span></th>
<th><span class="math inline">\(A = 2\)</span></th>
<th><span class="math inline">\(A = 3\)</span></th>
<th><span class="math inline">\(A = 4\)</span></th>
<th><span class="math inline">\(A = 5\)</span></th>
<th><span class="math inline">\(A = 6\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td><span class="math inline">\(\P(B &gt; A | A = a)\)</span></td>
<td><span class="math inline">\(5/6\)</span></td>
<td><span class="math inline">\(4/6 = 2/3\)</span></td>
<td><span class="math inline">\(3/6 = 1/2\)</span></td>
<td><span class="math inline">\(2/6 = 1/3\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td>0</td>
</tr>
<tr class="even">
<td><span class="math inline">\(\P(B = A | A = a)\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
</tr>
<tr class="odd">
<td><span class="math inline">\(\P(\text{B wins} | A = a)\)</span></td>
<td><span class="math inline">\(1\)</span></td>
<td><span class="math inline">\(5/6\)</span></td>
<td><span class="math inline">\(4/6 = 2/3\)</span></td>
<td><span class="math inline">\(3/6 = 1/2\)</span></td>
<td><span class="math inline">\(2/6 = 1/3\)</span></td>
<td><span class="math inline">\(1/6\)</span></td>
</tr>
</tbody>
</table>
<p>We can thus compute probabilities;</p>
<p><span class="math display">\[\P(\text{B wins}) = \sum_{a=1}^6 \P(\text{B wins} | A = a) \P(A = a) = \sum_{a=1}^6 \frac{7-a}{6} * \frac{2a-1}{36} = \frac{91}{216} \approx 42.1\%\]</span></p>
<p>and</p>
<p><span class="math display">\[\P(\text{A wins}) = 1 - \P(\text{B wins}) = \frac{125}{216} = 57.87\%\]</span></p>
<p>So A’s “advantage” is not as significant as it may seem.</p>
<p>In simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb33"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb33-2"><a href="#cb33-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">A1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>),</span>
<span id="cb33-3"><a href="#cb33-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">A2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>),</span>
<span id="cb33-4"><a href="#cb33-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">B  =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">6</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb33-5"><a href="#cb33-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">A =</span> <span class="fu">pmax</span>(A1, A2)) <span class="sc">|&gt;</span></span>
<span id="cb33-6"><a href="#cb33-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">A_wins =</span> A <span class="sc">&gt;</span> B,</span>
<span id="cb33-7"><a href="#cb33-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">B_wins =</span> B <span class="sc">&gt;=</span> A)  <span class="sc">|&gt;</span></span>
<span id="cb33-8"><a href="#cb33-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">P_A_wins =</span> <span class="fu">mean</span>(A_wins),</span>
<span id="cb33-9"><a href="#cb33-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">P_B_wins =</span> <span class="fu">mean</span>(B_wins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  P_A_wins P_B_wins
1 0.578734 0.421266</code></pre>
</div>
</div>
<p>If we roll dice with more sides, <em>e.g.</em> 20, the advantage to A becomes more pronounced:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb35"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb35-2"><a href="#cb35-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">A1 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-3"><a href="#cb35-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">A2 =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>),</span>
<span id="cb35-4"><a href="#cb35-4" aria-hidden="true" tabindex="-1"></a>           <span class="at">B  =</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span><span class="dv">20</span>, n, <span class="at">replace=</span><span class="cn">TRUE</span>)) <span class="sc">|&gt;</span></span>
<span id="cb35-5"><a href="#cb35-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">A =</span> <span class="fu">pmax</span>(A1, A2)) <span class="sc">|&gt;</span></span>
<span id="cb35-6"><a href="#cb35-6" aria-hidden="true" tabindex="-1"></a>    <span class="fu">mutate</span>(<span class="at">A_wins =</span> A <span class="sc">&gt;</span> B,</span>
<span id="cb35-7"><a href="#cb35-7" aria-hidden="true" tabindex="-1"></a>           <span class="at">B_wins =</span> B <span class="sc">&gt;=</span> A)  <span class="sc">|&gt;</span></span>
<span id="cb35-8"><a href="#cb35-8" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="at">P_A_wins =</span> <span class="fu">mean</span>(A_wins),</span>
<span id="cb35-9"><a href="#cb35-9" aria-hidden="true" tabindex="-1"></a>              <span class="at">P_B_wins =</span> <span class="fu">mean</span>(B_wins))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  P_A_wins P_B_wins
1 0.641454 0.358546</code></pre>
</div>
</div>
<p>As the number of faces increases, the probability of B winning converges to 1/3. (Can you see why?)</p>
</div>
</div>
</div>
</section>
<section id="question-26" class="level4">
<h4 class="anchored" data-anchor-id="question-26">Question 26</h4>
<p>Suppose <span class="math inline">\(X\)</span> follows a Pareto distribution with CDF <span class="math inline">\(F_X(x) = 1 - 1/x^4\)</span> supported on <span class="math inline">\([1, \infty)\)</span>. What is <span class="math inline">\(\E[X | X &gt; 5]\)</span>?</p>
<p><em>Hint: The Pareto distribution satisfies a `restarting’ property: <span class="math inline">\(F_{X|X &gt; x_0}(x) = 1 - (x_0/x)^4\)</span> supported on <span class="math inline">\([x_0, \infty)\)</span>.</em></p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-52-contents" aria-controls="callout-52" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-52" class="callout-52-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 2 with a slightly different Pareto distribution.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-53-contents" aria-controls="callout-53" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-53" class="callout-53-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We modify our solution to the <a href="./Test2/solutions.html#question-5">previous version of this question</a>.</p>
<p>Following the hint, to use this to get the <em>tail-conditional expectation</em>, we use the re-starting property to get the conditional PDF:</p>
<p><span class="math display">\[f_{X|X \geq x_0}(x) = F'_{X|X \geq x_0}(x) = \frac{\text{d}}{\text{d}x}\left(1 - \left( \frac{x_0}{x}\right)^4\right) = \frac{4x_0^4}{x^5}\]</span></p>
<p>This lets us compute the tail conditional expectation:</p>
<p><span class="math display">\[\begin{align*}
\E[X|X \geq 5] &amp;= \int_5^{\infty} x * f_{X|X \geq 5}(x)\,\text{d}x \\
&amp;= \int_5^{\infty} x * \frac{4 * 5^4}{x^5}\,\text{d}x \\
&amp;= 2500\int_5^{\infty} x^{-4}\,\text{d}x \\
&amp;= 2500\left(\left. -\frac{x^{-3}}{3}\right|_{x=5}^{\infty}\right) \\
&amp;= 2500 \left(-\frac{1}{\infty} - -\frac{5^{-3}}{3}\right) \\
&amp;= \frac{20}{3} \approx 6.667
\end{align*}\]</span></p>
<p>We can verify this in simulation. <code>R</code> doesn’t have a built-in Pareto RNG, but we can make our own pretty simply:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb37"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>rpareto <span class="ot">&lt;-</span> <span class="cf">function</span>(n, alpha) <span class="dv">1</span><span class="sc">/</span><span class="fu">runif</span>(n)<span class="sc">^</span>(<span class="dv">1</span><span class="sc">/</span>alpha)</span>
<span id="cb37-2"><a href="#cb37-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb37-3"><a href="#cb37-3" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rpareto</span>(<span class="fl">1e7</span>, <span class="at">alpha=</span><span class="dv">4</span>)</span>
<span id="cb37-4"><a href="#cb37-4" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(X[X <span class="sc">&gt;=</span> <span class="dv">5</span>])</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 6.668901</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-27" class="level4">
<h4 class="anchored" data-anchor-id="question-27">Question 27</h4>
<p>A group of 40 students are comparing their birthdays; as usual, assume their birthdays are independent, are not February 29th, <em>etc.</em> Find the expected number of pairs of people with birthdays in the same month. (To simplify calculations, you may assume the year has 12 months of 30 days each.)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-54-contents" aria-controls="callout-54" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-54" class="callout-54-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a question from Test 1, replacing days with months.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-55-contents" aria-controls="callout-55" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-55" class="callout-55-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For a given pair of people, there is a 1/12 chance that they are born in the same month (under our uniformity assumption). Since we have <span class="math inline">\(\binom{40}{2}=780\)</span> pairs, this gives us an expected number of “shared months” as <span class="math inline">\(780/12=65\)</span>.</p>
<p>We can verify this in simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb39"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>    birth_months <span class="ot">&lt;-</span> <span class="fu">sample</span>(month.name, <span class="dv">40</span>, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb39-3"><a href="#cb39-3" aria-hidden="true" tabindex="-1"></a>    N_shared <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">outer</span>(birth_months, birth_months, <span class="st">`</span><span class="at">==</span><span class="st">`</span>))</span>
<span id="cb39-4"><a href="#cb39-4" aria-hidden="true" tabindex="-1"></a>    (N_shared <span class="sc">-</span> <span class="dv">40</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb39-5"><a href="#cb39-5" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.01142</code></pre>
</div>
</div>
<p>We can modify the above code to deal with months of different lengths:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb41"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb41-2"><a href="#cb41-2" aria-hidden="true" tabindex="-1"></a>    birth_months <span class="ot">&lt;-</span> <span class="fu">sample</span>(month.name, <span class="dv">40</span>, <span class="at">replace=</span><span class="cn">TRUE</span>, </span>
<span id="cb41-3"><a href="#cb41-3" aria-hidden="true" tabindex="-1"></a>                           <span class="at">prob=</span><span class="fu">c</span>(<span class="dv">31</span>, <span class="dv">28</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>, <span class="dv">30</span>, <span class="dv">31</span>))</span>
<span id="cb41-4"><a href="#cb41-4" aria-hidden="true" tabindex="-1"></a>    N_shared <span class="ot">&lt;-</span> <span class="fu">sum</span>(<span class="fu">outer</span>(birth_months, birth_months, <span class="st">`</span><span class="at">==</span><span class="st">`</span>))</span>
<span id="cb41-5"><a href="#cb41-5" aria-hidden="true" tabindex="-1"></a>    (N_shared <span class="sc">-</span> <span class="dv">40</span>)<span class="sc">/</span><span class="dv">2</span></span>
<span id="cb41-6"><a href="#cb41-6" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 65.06593</code></pre>
</div>
</div>
<p>It seems the “equal month” assumption doesn’t materially change our findings.</p>
</div>
</div>
</div>
</section>
<section id="question-28" class="level4">
<h4 class="anchored" data-anchor-id="question-28">Question 28</h4>
<p>Let <span class="math inline">\(\overline{X}_n\)</span> be a random variable with a <span class="math inline">\(\mathcal{N}(16, 4/n)\)</span> distribution. Using the Delta Method, what is the approximate distribution of <span class="math inline">\(\sqrt{\overline{X}_n}\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-56-contents" aria-controls="callout-56" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-56" class="callout-56-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a Question from Test 3, applying a different transformation and with an addition factor of <span class="math inline">\(n\)</span> in the variance scaling.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-57-contents" aria-controls="callout-57" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-57" class="callout-57-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Under the delta method, we take</p>
<p><span class="math display">\[g(X)  \buildrel d\over \approx \mathcal{N}\left(g(\mu), g'(\mu)^2 \sigma^2\right) \]</span> Since here <span class="math inline">\(\V[X] \propto 1/n\)</span>, we can instead write this as:</p>
<p><span class="math display">\[g(X)  \buildrel d\over \approx \mathcal{N}\left(g(\mu), g'(\mu)^2 \sigma^2/n\right) \]</span></p>
<p>For us, <span class="math inline">\(g(x) = \sqrt{x}\)</span>, so <span class="math inline">\(g(\mu) = \sqrt{16} = 4\)</span> and <span class="math display">\[\begin{align*}
g'(x) &amp;= \frac{1}{2\sqrt{x}} \\
g'(x)^2 &amp;= \frac{1}{4x} \\
g'(16)^2 &amp;= \frac{1}{64} \\
\frac{\sigma^2}{n} g'(4)^2 &amp;= \frac{4}{n} * \frac{1}{64} \\
                 &amp;= \frac{1}{16n}
\end{align*}\]</span></p>
<p>Hence,</p>
<p><span class="math display">\[\sqrt{X} \buildrel d \over \approx \mathcal{N}\left(4, \frac{(1/4)^2}{n}\right)\]</span></p>
<p>In practice, this is pretty good, but not great, approximation. At <span class="math inline">\(n=1\)</span>,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb43"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="fl">1e6</span>, <span class="at">mean=</span><span class="dv">16</span>, <span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb43-2"><a href="#cb43-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-3"><a href="#cb43-3" aria-hidden="true" tabindex="-1"></a>gX <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(X)</span>
<span id="cb43-4"><a href="#cb43-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-5"><a href="#cb43-5" aria-hidden="true" tabindex="-1"></a><span class="fu">hist</span>(gX, <span class="at">probability=</span><span class="cn">TRUE</span>, <span class="at">breaks=</span><span class="dv">50</span>,</span>
<span id="cb43-6"><a href="#cb43-6" aria-hidden="true" tabindex="-1"></a>     <span class="at">main=</span><span class="st">"Density of Square Root of a Normal Distribution"</span>)</span>
<span id="cb43-7"><a href="#cb43-7" aria-hidden="true" tabindex="-1"></a>xx <span class="ot">&lt;-</span> <span class="fu">seq</span>(<span class="fu">min</span>(gX), <span class="fu">max</span>(gX), <span class="at">length.out=</span><span class="dv">401</span>)</span>
<span id="cb43-8"><a href="#cb43-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb43-9"><a href="#cb43-9" aria-hidden="true" tabindex="-1"></a><span class="fu">lines</span>(xx, <span class="fu">dnorm</span>(xx, <span class="at">mean=</span><span class="dv">4</span>, <span class="at">sd=</span><span class="dv">1</span><span class="sc">/</span><span class="dv">4</span>), <span class="at">col=</span><span class="st">"red4"</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-23-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
</div>
</div>
</div>
<p>The quality of the approximation improves as <span class="math inline">\(n \to \infty\)</span> and <span class="math inline">\(\V[\overline{X}_n] \to 0\)</span>.</p>
</section>
<section id="question-29" class="level4">
<h4 class="anchored" data-anchor-id="question-29">Question 29</h4>
<p>Suppose Stephen is playing a guessing game, where he has a 20% chance of answering a given question correctly (IID). If he answers a question correctly, he gets one point. Let <span class="math inline">\(Q\)</span> be the total number of questions required for him to get 4 points. What is <span class="math inline">\(\E[Q]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-58-contents" aria-controls="callout-58" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-58" class="callout-58-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a variant of a question from Test 1, here asking about the mean instead of the variance.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-59-contents" aria-controls="callout-59" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-59" class="callout-59-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>The expected time to get one point is <span class="math inline">\(1/p = 1/0.2 = 5\)</span> so by linearity of expectation the expected total time required is <span class="math inline">\(4 * 5 = 20\)</span>.</p>
<p>You can also approach this by recognizing <span class="math inline">\(Q \sim \text{NegBinom}(r=4, p=0.2)\)</span> and hence <span class="math inline">\(\E[Q] = r/p = \frac{4}{0.2} = 20\)</span> but I find the direct linearity argument more compelling.</p>
</div>
</div>
</div>
</section>
<section id="question-30" class="level4">
<h4 class="anchored" data-anchor-id="question-30">Question 30</h4>
<p><span class="math inline">\(X\)</span> is a mixture distribution defined as follows:</p>
<ul>
<li><span class="math inline">\(X_1 \sim \mathcal{N}(2, 5^2)\)</span>;</li>
<li><span class="math inline">\(X_2 \sim \text{Poisson}(5)\)</span>; and</li>
<li><span class="math inline">\(X_3 \sim \text{ContinuousUniform}([-3, 3])\)</span>.</li>
<li><span class="math inline">\(Z\)</span> is uniform on <span class="math inline">\(\{1, 2, 3\}\)</span> and</li>
<li><span class="math inline">\(X = X_Z\)</span>.</li>
</ul>
<p>That is, <span class="math inline">\(X\)</span> is the value of each mixture arm with equal probability. <span class="math inline">\(Z, X_1, X_2, X_3\)</span> are all independent. Compute the expected value of <span class="math inline">\(X\)</span>.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-60-contents" aria-controls="callout-60" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-60" class="callout-60-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>A question on Test 1 asked for the <em>variance</em> of this mixture, instead of the <em>mean</em>.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-61-contents" aria-controls="callout-61" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-61" class="callout-61-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>By the law of total expectation:</p>
<p><span class="math display">\[\begin{align*}
X &amp;= X_1 * (Z == 1) + X_2 * (Z == 2) + X_3 * (Z == 3) \\
\E[X] &amp;= \E[X_1 * (Z == 1) + X_2 * (Z == 2) + X_3 * (Z == 3)] \\
      &amp;= \E[X_1] * \E[Z == 1] + \E[X_2] * \E[Z == 2] + \E[X_3] * \E[Z == 3] \\
      &amp;= \E[X_1] * \P[Z = 1] + \E[X_2] * \P[Z = 2] + \E[X_3] * \P[Z = 3] \\
      &amp;= 2 * \frac{1}{3} + 5 * \frac{1}{3} + 0 * \frac{1}{3} \\
      &amp;= \frac{7}{3}
\end{align*}\]</span></p>
<p>In simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb44"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb44-2"><a href="#cb44-2" aria-hidden="true" tabindex="-1"></a>    X1 <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, <span class="at">mean=</span><span class="dv">2</span>, <span class="at">sd=</span><span class="dv">5</span>)</span>
<span id="cb44-3"><a href="#cb44-3" aria-hidden="true" tabindex="-1"></a>    X2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(<span class="dv">1</span>, <span class="dv">5</span>)</span>
<span id="cb44-4"><a href="#cb44-4" aria-hidden="true" tabindex="-1"></a>    X3 <span class="ot">&lt;-</span> <span class="fu">runif</span>(<span class="dv">1</span>, <span class="sc">-</span><span class="dv">3</span>, <span class="dv">3</span>)</span>
<span id="cb44-5"><a href="#cb44-5" aria-hidden="true" tabindex="-1"></a>    X <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(X1, X2, X3), <span class="dv">1</span>)</span>
<span id="cb44-6"><a href="#cb44-6" aria-hidden="true" tabindex="-1"></a>    X</span>
<span id="cb44-7"><a href="#cb44-7" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 2.342827</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-31" class="level4">
<h4 class="anchored" data-anchor-id="question-31">Question 31</h4>
<p>Suppose it takes a student 2 minutes on average to answer a question on an exam. Furthermore, assume that it never takes the student less than 1 minute or more than 5 minutes to answer a single question. Assuming the exam has 40 questions total and that the time taken on each question is IID, use the Chernoff inequality for <em>means of bounded random variables</em> to give an upper bound on the probability that it takes more than two hours to finish the exam.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-62-contents" aria-controls="callout-62" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-62" class="callout-62-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This question appeared verbatim on Test 3.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-63-contents" aria-controls="callout-63" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-63" class="callout-63-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We repeat our <a href="./Test3/solutions.html#question-6">solution from Test 3</a>:</p>
<p>We apply the Chernoff bound for means of bounded random variables. Here, we take the variables to fall in the range <span class="math inline">\([1, 5]\)</span>, each with mean 2. For the student to take more than 2 hours to finish the exam, the average time per question must be greater than <span class="math inline">\(3\)</span> minutes. We put these numbers into the Chernoff bound to get:</p>
<p><span class="math display">\[\P(\overline{T}_{40} &gt; E[\overline{T}_{40}] + 1) \leq e^{-2n t^2/(b-a)^2} = e^{-2 * 40 * 1^2 / (5-1)^2} = e^{-80/16} = e^{-5} \approx 0.67\%\]</span> Here we see that by taking advantage of the <em>mean</em> structure of <span class="math inline">\(T\)</span> (or equivalently, the IID sum structure), we are able to get a <strong>very tight</strong> bound on the probability of the student not being able to finish the exam in the permitted 2 hour time.</p>
</div>
</div>
</div>
</section>
<section id="question-32" class="level4">
<h4 class="anchored" data-anchor-id="question-32">Question 32</h4>
<p>Let <span class="math inline">\(X\)</span> be the number of Heads in 10 fair coin tosses, assumed IID. Find the conditional variance of <span class="math inline">\(X\)</span>, conditional that the first two tosses do not match (<em>i.e.</em>, no HH or no TT).</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-64-contents" aria-controls="callout-64" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-64" class="callout-64-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a minor tweak to a question from Test 1, changing the conditioning in an irrelevant way.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-65-contents" aria-controls="callout-65" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-65" class="callout-65-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Under the conditioning, there is always exactly one H in the “end rolls”, so this question is really just asking about the variance of the 8 “middle rolls”, which are binomially distributed.</p>
<p><span class="math display">\[\V[\text{Binom}(8, 0.5)] = 8 * 0.5 * (1-0.5) = 2\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-33" class="level4">
<h4 class="anchored" data-anchor-id="question-33">Question 33</h4>
<p>Suppose that a mother and daughter are selected from a population whose heights are <span class="math inline">\(\mathcal{N}(66, 4^2)\)</span>; suppose further that the correlation between heights within a family is <span class="math inline">\(\rho = 25\%\)</span>. What is the probability that the mother is more than 4 inches taller than her daughter?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-66-contents" aria-controls="callout-66" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-66" class="callout-66-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a question from Test 2, with different numbers.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-67-contents" aria-controls="callout-67" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-67" class="callout-67-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We adapt <a href="./Test2/solutions.html#question-10">our answer from Test 2</a>.</p>
<p>Let <span class="math inline">\(M, D\)</span> be the heights of the father and son respectively. We have</p>
<p><span class="math display">\[\P(M &gt; D + 4) = \P(M - D &gt; 4)  = 1 - \P(M - D &lt; 4) = 1 - F_{M - D}(4)\]</span></p>
<p>so we just need to compute the CDF of <span class="math inline">\(M - D\)</span>. Since <span class="math inline">\(M, D\)</span> are jointly normal, their difference is also normal. We thus only need to compute its mean and variance.</p>
<p><span class="math display">\[\E[M - D] = \E[M] - \E[D] = 66 - 66 = 0\]</span></p>
<p>and</p>
<p><span class="math display">\[\V[M - D] = \V[M] - 2\C[M, D] + \V[D] =
\sigma_M^2 - 2 \sigma_M\sigma_D\rho_{M, D} + \sigma_F^2
= 4^2 - 2 * 4 * 4 * \frac{1}{4} + 4^2 = 24\]</span></p>
<p>Hence, standardization of <span class="math inline">\(S - F\)</span> gives us:</p>
<p><span class="math display">\[\P(M &gt; D + 4) = 1 - F_{M-D}(4) = 1 - \Phi\left(\frac{4 - 0}{\sqrt{24}}\right) \approx 20.7\%\]</span></p>
<p>Again, we can verify this in simulation. We need to be able to generate correlated variables and most multivariate normal samplers take the variance matrix as the input:</p>
<p><span class="math display">\[\V[(M, D)] = \begin{pmatrix} 4^2 &amp; 4 * 4 * \frac{1}{4} \\ 4 * 4 * \frac{1}{4} &amp; 4^2 \end{pmatrix} = \begin{pmatrix} 16 &amp; 4 \\ 4 &amp; 16 \end{pmatrix}\]</span> Next, we use <code>MASS::mvrnorm</code> to generate our samples:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb46"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(MASS)</span>
<span id="cb46-2"><a href="#cb46-2" aria-hidden="true" tabindex="-1"></a>mu <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">66</span>, <span class="dv">66</span>)</span>
<span id="cb46-3"><a href="#cb46-3" aria-hidden="true" tabindex="-1"></a>Sigma <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="fu">c</span>(<span class="dv">16</span>, <span class="dv">4</span>, <span class="dv">4</span>, <span class="dv">16</span>), <span class="at">nrow=</span><span class="dv">2</span>)</span>
<span id="cb46-4"><a href="#cb46-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">mvrnorm</span>(<span class="fl">1e7</span>, mu, Sigma)</span>
<span id="cb46-5"><a href="#cb46-5" aria-hidden="true" tabindex="-1"></a>MOM_HT <span class="ot">&lt;-</span> X[,<span class="dv">1</span>]</span>
<span id="cb46-6"><a href="#cb46-6" aria-hidden="true" tabindex="-1"></a>DAU_HT <span class="ot">&lt;-</span> X[,<span class="dv">2</span>]</span>
<span id="cb46-7"><a href="#cb46-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb46-8"><a href="#cb46-8" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(MOM_HT <span class="sc">&gt;</span> DAU_HT <span class="sc">+</span> <span class="dv">4</span>)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.207063</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-34" class="level4">
<h4 class="anchored" data-anchor-id="question-34">Question 34</h4>
<p>The <span class="math inline">\(\text{Skellam}(\mu_1, \mu_2)\)</span> distribution is given by <span class="math inline">\(X = N_1 - N_2\)</span> where <span class="math inline">\(N_1, N_2\)</span> are independent Poisson random variables, with mean <span class="math inline">\(\mu_1, \mu_2\)</span> respectively. What is the variance of a <span class="math inline">\(\text{Skellam}(4, 3)\)</span> distribution?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-68-contents" aria-controls="callout-68" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-68" class="callout-68-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question, designed to test your use of variance formulas. The Skellam distribution is commonly used to measure the win differential in a soccer match. (Can you argue why this is a reasonable model?)</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-69-contents" aria-controls="callout-69" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-69" class="callout-69-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Because <span class="math inline">\(N_1, N_2\)</span> are independent, this is straightforward:</p>
<p><span class="math display">\[\begin{align*}
\V[N_1 - N_2] &amp;= \V[N_1] + \V[N_2] \\
              &amp;= 4 + 3 \\
              &amp;= 7
\end{align*}\]</span></p>
<p>In simulation</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb48"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb48-2"><a href="#cb48-2" aria-hidden="true" tabindex="-1"></a>N1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">4</span>)</span>
<span id="cb48-3"><a href="#cb48-3" aria-hidden="true" tabindex="-1"></a>N2 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(n, <span class="dv">3</span>)</span>
<span id="cb48-4"><a href="#cb48-4" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> N1 <span class="sc">-</span> N2</span>
<span id="cb48-5"><a href="#cb48-5" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(X)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 7.004423</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-35" class="level4">
<h4 class="anchored" data-anchor-id="question-35">Question 35</h4>
<p>In a <em>mixed-effects</em> regression model, the response is determined by a combination of a noise term, a non-random “fixed effect” term, and a subject specific “random effect” term. Symbolically, the vector of responses <span class="math inline">\(\by\)</span> is distributed as <span class="math display">\[\by |\bb \sim \mathcal{N}(\bZ\bb + \bX\bbeta, \sigma^2 \bI) \text{ where } \bb \sim \mathcal{N}(\bzero, \nu^2 \bI)\]</span> What is the (unconditional) variance matrix of <span class="math inline">\(\by\)</span>? Here <span class="math inline">\(\bZ, \bX\)</span> are fixed (non-random) matrices and <span class="math inline">\(\bbeta\)</span> is a fixed (non-random) vector.</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-70-contents" aria-controls="callout-70" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-70" class="callout-70-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question, designed to test your use with the matrix algebra used to compute multivariate variances. It’s also a good way to see how properties of the multivariate normal can be used to analyze more complex dependency structures you will learn in later courses.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-71-contents" aria-controls="callout-71" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-71" class="callout-71-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We note that, by definition,</p>
<p><span class="math display">\[\by = \bZ\bb + X\bbeta + \bepsilon\]</span></p>
<p>where <span class="math inline">\(\bb \sim \mathcal{N}(\bzero, \nu^2 \bI)\)</span> and <span class="math inline">\(\bepsilon \sim \mathcal{N}(0,
\sigma^2\bI)\)</span>. Hence,</p>
<p><span class="math display">\[\begin{align*}
\V[\by] &amp;= \V\left[ \bZ\bb + X\bbeta + \bepsilon\right] \\
        &amp;= \V[\bZ\bb] + \V[\bepsilon] \\
        &amp;= \bZ\V[\bb]\bZ^{\top} + \V[\bepsilon] \\
        &amp;= \bZ(\nu^2 \bI)\bZ^{\top} + \sigma^2 \bI \\
        &amp;= \nu^2 \bZ\bZ^{\top} + \sigma^2 \bI
\end{align*}\]</span></p>
</div>
</div>
</div>
</section>
<section id="question-36" class="level4">
<h4 class="anchored" data-anchor-id="question-36">Question 36</h4>
<p>Suppose that the random variables <span class="math inline">\((X, Y)\)</span> have joint PDF <span class="math inline">\(f_{(X, Y)}=1\)</span> with support on the unit square <span class="math inline">\([0, 1]^2\)</span>. What is the probability that <span class="math inline">\(X &gt; Y\)</span> given <span class="math inline">\(Y &gt; 0.5\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-72-contents" aria-controls="callout-72" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-72" class="callout-72-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is looks like variant of a problem from Test 1, but here the uniform density makes things far easier.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-73-contents" aria-controls="callout-73" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-73" class="callout-73-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Graphically, we divide the unit square into several regions:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb50"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>alpha <span class="ot">&lt;-</span> scales<span class="sc">::</span>alpha</span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a><span class="fu">plot</span>(<span class="at">x=</span><span class="dv">0</span>, <span class="at">y=</span><span class="dv">0</span>, <span class="at">xlim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), <span class="at">ylim=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>), </span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>     <span class="at">type=</span><span class="st">"n"</span>, <span class="at">xlab=</span><span class="st">"X"</span>, <span class="at">ylab=</span><span class="st">"Y"</span>, <span class="at">asp=</span><span class="dv">1</span>)</span>
<span id="cb50-4"><a href="#cb50-4" aria-hidden="true" tabindex="-1"></a><span class="fu">segments</span>(<span class="at">x0=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y0=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">0</span>), </span>
<span id="cb50-5"><a href="#cb50-5" aria-hidden="true" tabindex="-1"></a>         <span class="at">x1=</span><span class="fu">c</span>(<span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>, <span class="dv">1</span>), <span class="at">y1=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb50-6"><a href="#cb50-6" aria-hidden="true" tabindex="-1"></a>         <span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb50-7"><a href="#cb50-7" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>, <span class="dv">0</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="fl">0.5</span>, <span class="fl">0.5</span>, <span class="dv">1</span>, <span class="dv">1</span>), </span>
<span id="cb50-8"><a href="#cb50-8" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"pink"</span>, <span class="fl">0.5</span>))</span>
<span id="cb50-9"><a href="#cb50-9" aria-hidden="true" tabindex="-1"></a><span class="fu">polygon</span>(<span class="at">x=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">1</span>), <span class="at">y=</span><span class="fu">c</span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="dv">0</span>), </span>
<span id="cb50-10"><a href="#cb50-10" aria-hidden="true" tabindex="-1"></a>        <span class="at">col=</span><span class="fu">alpha</span>(<span class="st">"lightblue"</span>, <span class="fl">0.5</span>))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<div>
<figure class="figure">
<p><img src="solutions_files/figure-html/unnamed-chunk-27-1.png" class="img-fluid figure-img" width="672"></p>
</figure>
</div>
</div>
</div>
<p>Here, the pink region denotes the area where <span class="math inline">\(Y &gt; 0.5\)</span> while the blue region denotes the area where <span class="math inline">\(X &gt; Y\)</span>. Since we condition on <span class="math inline">\(Y &gt; 0.5\)</span>, by uniformity, we are looking for the ratio of the purple (pink + blue) region to the pink region. By inspection, this is <span class="math inline">\(1/8\)</span> divided by <span class="math inline">\(1/2\)</span> or <span class="math inline">\(\frac{1}{4}\)</span>.</p>
<p>In simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb51"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a><span class="fu">library</span>(dplyr)</span>
<span id="cb51-2"><a href="#cb51-2" aria-hidden="true" tabindex="-1"></a><span class="fu">data.frame</span>(<span class="at">X =</span> <span class="fu">runif</span>(<span class="fl">1e6</span>), </span>
<span id="cb51-3"><a href="#cb51-3" aria-hidden="true" tabindex="-1"></a>           <span class="at">Y =</span> <span class="fu">runif</span>(<span class="fl">1e6</span>)) <span class="sc">|&gt;</span></span>
<span id="cb51-4"><a href="#cb51-4" aria-hidden="true" tabindex="-1"></a>    <span class="fu">filter</span>(Y <span class="sc">&gt;</span> <span class="fl">0.5</span>) <span class="sc">|&gt;</span> </span>
<span id="cb51-5"><a href="#cb51-5" aria-hidden="true" tabindex="-1"></a>    <span class="fu">summarize</span>(<span class="fu">mean</span>(X <span class="sc">&gt;</span> Y))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  mean(X &gt; Y)
1   0.2497212</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-37" class="level4">
<h4 class="anchored" data-anchor-id="question-37">Question 37</h4>
<p>A Laplace distribution can be formed as <span class="math inline">\(L = S* E\)</span> where <span class="math inline">\(S\)</span> is a discrete uniform random variable taking values <span class="math inline">\(\{-1, +1\}\)</span> and <span class="math inline">\(E\)</span> is an exponential random variable with mean <span class="math inline">\(\lambda\)</span> and <span class="math inline">\(S\)</span> and <span class="math inline">\(E\)</span> are independent. What are <span class="math inline">\(\E[L]\)</span> (2 points) and <span class="math inline">\(\V[L]\)</span> (3 points)?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-74-contents" aria-controls="callout-74" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-74" class="callout-74-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question, using basic expectation and variance calculations.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-75-contents" aria-controls="callout-75" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-75" class="callout-75-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>For expectation,</p>
<p><span class="math display">\[\begin{align*}
\E[L] &amp;= \E[SE] \\
      &amp;= \E[S]\E[E] \\
      &amp;= 0 * \E[E] \\
      &amp;= 0
\end{align*}\]</span></p>
<p>For variance, we have several options, here let’s proceed by conditioning on <span class="math inline">\(S\)</span>:</p>
<p><span class="math display">\[\begin{align*}
\V[L] &amp;= \V[SE] \\
      &amp;= \V_S[\E_E[SE]] + \E_S[\V_E[SE]] \\
      &amp;= \V_S[S \E_E[E]] + \E_S[S^2\V_E[E]] \\
      &amp;= \V_S[S \E_E[E]] + \E_S[S^2 \V_E[E]] \\
      &amp;= \V_S[S * \lambda] + \lambda^2\E_S[S * \lambda^2] \\
      &amp;= \lambda^2(\V_S[S] + \E_S[S^2]) \\
      &amp;= \lambda^2(1 + 1) \\
      &amp;= 2\lambda^2
\end{align*}\]</span></p>
<p>where we use the fact that <span class="math inline">\(\E[E] = \lambda\)</span> and <span class="math inline">\(\V[E] = \lambda^2\)</span>.</p>
<p>For the version of this question appearing on the exam, I set <span class="math inline">\(\lambda=3\)</span>, so <span class="math inline">\(\E[L] = 0\)</span> and <span class="math inline">\(\V[L] = 18\)</span>.</p>
<p>We can verify this in simulation:</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb53"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>MEAN <span class="ot">&lt;-</span> <span class="dv">3</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>S <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="sc">-</span><span class="dv">1</span>, <span class="sc">+</span><span class="dv">1</span>), n, <span class="at">replace=</span><span class="cn">TRUE</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>E <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, <span class="at">rate=</span><span class="dv">1</span><span class="sc">/</span>MEAN)</span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>L <span class="ot">&lt;-</span> S <span class="sc">*</span> E</span>
<span id="cb53-8"><a href="#cb53-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb53-9"><a href="#cb53-9" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] -0.002563422</code></pre>
</div>
<div class="sourceCode cell-code" id="cb55"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a><span class="fu">var</span>(L)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 17.97233</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-38" class="level4">
<h4 class="anchored" data-anchor-id="question-38">Question 38</h4>
<p>Suppose <span class="math inline">\(Z_1, \dots, Z_7\)</span> are IID standard normal random variables. What is the probability that <span class="math inline">\(\textsf{median}(Z_1, \dots, Z_7)\)</span> is positive? (Recall that the median of a set of 7 values is the middle value, <em>i.e.</em>, the fourth largest when sorted.)</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-76-contents" aria-controls="callout-76" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-76" class="callout-76-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question. It’s designed to test your understanding of order order statistics like the median. The use of the standard normal here turns out to not be too important; the only fact we need is <span class="math inline">\(\Phi(0) = 0.5\)</span> so the probability of a single value being positive is 50%.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-77-contents" aria-controls="callout-77" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-77" class="callout-77-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>We note that “positive or not” is a Bernoulli random variable, so we are simply seeking the probability that 4 or more Bernoulli RVs (out of 7) are successes. Here, each event happens independently with probability <span class="math inline">\(\Phi(0) = 0.5\)</span> so, we simply need the “upper tail” of the <span class="math inline">\(\text{Binom}(7, 0.5)\)</span> distribution.</p>
<p><span class="math display">\[\sum_{k=4}^7 \binom{7}{k} 0.5^k (1-0.5)^{7-k} = \sum_{k=4}^7 \binom{7}{k} 0.5^7 = 0.5^7 \sum_{k=4}^y \binom{7}{k} = \frac{35 + 21 + 7 + 1}{2^7} = 0.5\]</span></p>
<p>In retrospect, we can also see that this follows from the symmetry of the standard normal around <span class="math inline">\(0\)</span>.</p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb57"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a><span class="fu">mean</span>(<span class="fu">replicate</span>(<span class="fl">1e5</span>, {</span>
<span id="cb57-2"><a href="#cb57-2" aria-hidden="true" tabindex="-1"></a>    Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">7</span>)</span>
<span id="cb57-3"><a href="#cb57-3" aria-hidden="true" tabindex="-1"></a>    <span class="fu">median</span>(Z) <span class="sc">&gt;</span> <span class="dv">0</span></span>
<span id="cb57-4"><a href="#cb57-4" aria-hidden="true" tabindex="-1"></a>}))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.49768</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-39" class="level4">
<h4 class="anchored" data-anchor-id="question-39">Question 39</h4>
<p>Let <span class="math inline">\(X \sim \mathcal{N}(1, 4)\)</span> be a Gaussian random variable. Additionally, conditional on <span class="math inline">\(X=x\)</span>, let <span class="math inline">\(Y, Z\)</span> be independent <span class="math inline">\(\mathcal{N}(3x, 1)\)</span> random variables. What is <span class="math inline">\(\C[X, Y + Z]\)</span>?</p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-78-contents" aria-controls="callout-78" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-78" class="callout-78-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question, inspired by the student-submitted practice problems.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-79-contents" aria-controls="callout-79" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-79" class="callout-79-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>Note that <span class="math inline">\(Y = 3X + W_1\)</span> and <span class="math inline">\(Z = 3X + W_2\)</span> where <span class="math inline">\(W_1, W_2\)</span> are independent standard normal random variables. We then substitute and simplify:</p>
<p><span class="math display">\[\begin{align*}
\C[X, Y + Z] &amp;= \C[X, 3X + W_1 + 3X + W_2] \\
             &amp;= \C[X, 6X + W_1 + W_2] \\
             &amp;= \C[X, 6X] + \C[X, W_1] + \C[X, W_2] \\
             &amp;= 6 \V[X] + 0 + 0 \\
             &amp;= 6 * 4 \\
             &amp;= 24
\end{align*}\]</span></p>
<p>where <span class="math inline">\(\C[X, W_1] = \C[X, W_2]\)</span> by independence.</p>
<p>In simulation,</p>
<div class="cell">
<div class="sourceCode cell-code" id="cb59"><pre class="sourceCode r code-with-copy"><code class="sourceCode r"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fl">1e6</span></span>
<span id="cb59-2"><a href="#cb59-2" aria-hidden="true" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">1</span>, <span class="at">sd=</span><span class="dv">2</span>)</span>
<span id="cb59-3"><a href="#cb59-3" aria-hidden="true" tabindex="-1"></a>Y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">3</span> <span class="sc">*</span> X, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb59-4"><a href="#cb59-4" aria-hidden="true" tabindex="-1"></a>Z <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(n, <span class="at">mean=</span><span class="dv">3</span> <span class="sc">*</span> X, <span class="at">sd=</span><span class="dv">1</span>)</span>
<span id="cb59-5"><a href="#cb59-5" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb59-6"><a href="#cb59-6" aria-hidden="true" tabindex="-1"></a><span class="fu">cov</span>(X, Y <span class="sc">+</span> Z)</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 24.00743</code></pre>
</div>
</div>
</div>
</div>
</div>
</section>
<section id="question-40" class="level4">
<h4 class="anchored" data-anchor-id="question-40">Question 40</h4>
<p>Consider the standard linear model <span class="math inline">\(\by = \bX\bbeta + \bepsilon\)</span>, but we now assume <span class="math inline">\(\bepsilon \sim \mathcal{N}(\bzero, \bSigma)\)</span> instead of IID. What is the (co)variance matrix of the OLS estimator <span class="math display">\[\hat{\bbeta} = (\bX^{\top}\bX)^{-1}\bX^{\top}\by?\]</span></p>
<div class="callout callout-style-default callout-note callout-titled" title="Question History">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-80-contents" aria-controls="callout-80" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Question History
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-80" class="callout-80-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p>This is a new question, designed to make sure you can derive the variance of OLS. Here, we add dependence among the noise terms, <em>e.g.</em>, as you might see in a time series model.</p>
</div>
</div>
</div>
<div class="callout callout-style-default callout-tip callout-titled" title="Solution">
<div class="callout-header d-flex align-content-center" data-bs-toggle="collapse" data-bs-target=".callout-81-contents" aria-controls="callout-81" aria-expanded="false" aria-label="Toggle callout">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-title-container flex-fill">
Solution
</div>
<div class="callout-btn-toggle d-inline-block border-0 py-1 ps-1 pe-0 float-end"><i class="callout-toggle"></i></div>
</div>
<div id="callout-81" class="callout-81-contents callout-collapse collapse">
<div class="callout-body-container callout-body">
<p><span class="math display">\[\begin{align*}
\V[\hat{\bbeta}] &amp;= \V[(\bX^{\top}\bX)^{-1}\bX^{\top}\by] \\
                 &amp;= (\bX^{\top}\bX)^{-1}\bX^{\top}\V[\by][(\bX^{\top}\bX)^{-1}\bX^{\top}]^{\top} \\
                 &amp;= (\bX^{\top}\bX)^{-1}\bX^{\top}\V[\by]\bX(\bX^{\top}\bX)^{-1} \\
                 &amp;= (\bX^{\top}\bX)^{-1}\bX^{\top}\V[\bX\bbeta + \bepsilon]\bX(\bX^{\top}\bX)^{-1} \\
                 &amp;= (\bX^{\top}\bX)^{-1}\bX^{\top}\V[\bepsilon]\bX(\bX^{\top}\bX)^{-1} \\
                 &amp;= (\bX^{\top}\bX)^{-1}\bX^{\top}\bSigma\bX(\bX^{\top}\bX)^{-1} \\
\end{align*}\]</span></p>
<p>In the common case where <span class="math inline">\(\bSigma = \sigma^2 \bI\)</span>, this simplifies as</p>
<p><span class="math display">\[(\bX^{\top}\bX)^{-1}\bX^{\top}(\sigma^2 \bI)\bX(\bX^{\top}\bX)^{-1} = \sigma^2(\bX^{\top}\bX)^{-1}\]</span></p>
<p>which is the standard OLS variance.</p>
<p>In general, this is not an optimal variance and so we use weighted and/or generalized least squares (WLS/GLS) to account for structured error terms.</p>
</div>
</div>
</div>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp("https:\/\/michael-weylandt\.com\/STA9715\/");
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->




</body></html>